<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<meta name="theme-color" content="#ffffff"/>
<title>Aurora UI ‚Äî Infecciosas 2.0 (v3.3)</title>
<link rel="manifest" href="manifest.webmanifest"/>
<link rel="icon" href="icons/icon-192.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="icons/icon-192.png"/>

<style>
/* ===== AJUSTES SOLICITADOS (sin tocar nada m√°s) ==========================
   - Iconos (toggle/editar/completar): centrados y proporcionales al bot√≥n
   - Barra inferior: siempre visible con margen inferior suficiente
   - Listas comprimidas sin saltos excesivos y texto n√≠tido
   - Evitar solapamientos de headers sticky
   ======================================================================= */

:root{
  --bg:#ffffff; --ink:#0b1220; --muted:#77809b; --muted-2:#8a94b0; --border:#e7ecf3;
  --indigo-500:#6366F1; --indigo-600:#4F46E5; --coral-500:#fb7185; --teal-500:#14b8a6; --gold-500:#f59e0b;
  --appbar:64px; --pad:16px; --radius:16px; --shadow-1:0 6px 24px rgba(12,18,28,.08);
  --bottom-h:72px; --glass-bg:linear-gradient(180deg, rgba(255,255,255,.86) 0%, rgba(255,255,255,.96) 100%);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.35 system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial}

.container{width:min(1100px,100%);margin-inline:auto;padding-inline:var(--pad)}
.flow > *+*{margin-top:8px}
.grid{display:grid;gap:12px}
.flex{display:flex;gap:12px}
.center{display:grid;place-items:center}
.grow{flex:1;min-width:0}
.hide{display:none !important}
.muted{color:var(--muted)}
.toolbar{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
svg.ico{display:block}

/* ---------- APPBAR y HEADERS (sin cambios de fondo; z-index asegurado) ---------- */
header.appbar{position:sticky; top:0; z-index:50; min-height:var(--appbar); display:flex; align-items:center;
  background: var(--glass-bg); border-bottom:1px solid var(--border)}
.appbar .container{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.brand{padding:10px 14px;border-radius:999px;border:1px solid var(--border);background:#fff;display:flex;align-items:center;gap:10px;font-weight:1000;letter-spacing:.2px}
.brand-dot{width:10px;height:10px;border-radius:50%;background:var(--gold-500)}
h1#title{margin:0;font-size:clamp(18px,2.2vw,22px);font-weight:1000;letter-spacing:.2px;color:#0e1624;filter:drop-shadow(0 1px 0 rgba(0,0,0,.05))}

.card{background: linear-gradient(180deg, rgba(255,255,255,.90) 0%, rgba(255,255,255,.98) 100%);
  border:1px solid var(--border); border-radius:18px; box-shadow:0 12px 32px rgba(10,20,40,.08);
  overflow:hidden; contain:content}
.card-h{position:relative; padding:16px 18px 18px 18px; display:flex; align-items:center; justify-content:space-between; gap:10px;
  border-bottom:1px solid var(--border); background:linear-gradient(180deg, color-mix(in oklab,#fff,#000,transparent 90%), #fff)
  ; isolation:isolate; }
.card-h h2{margin:0;font-size:clamp(16px,1.9vw,20px);letter-spacing:.2px}
.card-b{padding:12px 16px 16px 16px}

/* ---------- LISTAS / INPUTS (estructura estable) ---------- */
ul.list{list-style:none;padding:0;margin:0}
li.item{display:flex;align-items:flex-start;gap:12px;padding:10px 8px;border-bottom:1px solid var(--border)}
li.item:last-child{border-bottom:none}
.item .left{width:28px;min-width:28px;display:grid;place-items:center}
.item .text{min-width:0}
.item .actions{margin-left:auto;display:flex;gap:6px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#fff;font-weight:800}
.btn.primary{background:linear-gradient(180deg,#ffffff,#f4f7ff);border-color:#dfe6f4}
.pill{display:inline-flex;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#fff}
.pill.date{font-weight:1000}
.pill.tel{font-weight:800}

/* Visibilidad premium: multi-l√≠nea sin recortes (Planta/Tareas/Directorio) */
.item .text{
  display:grid;
  grid-auto-rows:auto;
  gap:4px;
  align-items:start;
  min-width:0;
}
.item .text > *{
  white-space:normal;
  overflow:visible;
  text-overflow:clip;
  max-width:100%;
  word-break:break-word;
}

/* Directorio: nombre en bloque, tel√©fonos con wrap en varias l√≠neas */
#panel-directorio .item .text strong{display:block; font-weight:1000}
#panel-directorio .pill.tel{display:inline-flex; margin:2px 6px 2px 0; white-space:nowrap}
#panel-directorio .text{gap:6px}

/* ---------- BOTTOM BAR fija (√≠conos a la izda + etiqueta a la dcha) ---------- */
nav.bottom{position:fixed;left:0;right:0;bottom:0;z-index:40;background:var(--glass-bg);border-top:1px solid var(--border);height:var(--bottom-h)}
.bottom .container{display:flex;align-items:center;justify-content:space-between;height:100%;gap:12px}
.bottom .icons{display:flex;gap:12px}
.bottom .chip{margin-left:auto;display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:999px;border:1px solid var(--border);background:#fff;font-weight:1000}

/* M√°s resguardo para que la bottom bar jam√°s tape el √∫ltimo √≠tem */
main.container{ padding-bottom: calc(var(--bottom-h) + env(safe-area-inset-bottom) + 72px) }

/* ---------- DIRECTORIO (A‚ÄìZ lateral + encabezados sticky) ---------- */
.az{position:fixed;right:6px;top:calc(var(--appbar) + 6px);bottom:calc(var(--bottom-h) + 6px);display:flex;flex-direction:column;gap:6px}
.az a{display:grid;place-items:center;width:28px;min-height:28px;border-radius:8px;border:1px solid var(--border);background:#fff;font-weight:1000}

.section-tag{
  position:sticky; top:calc(var(--appbar) + 8px); z-index:2;
  margin:-12px; margin-bottom:8px; padding:10px 12px;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  border-radius:14px; border:1px solid var(--border);
  background:linear-gradient(180deg,#ffffff 0%, #f7f9fc 100%);
  box-shadow:0 10px 24px rgba(7,16,31,.06), inset 0 1px 0 #fff;
  backdrop-filter: blur(6px);
}
.section-tag .lbl{
  display:inline-grid; place-items:center;
  width:46px; height:46px; border-radius:12px;
  font-size:24px; font-weight:1000; letter-spacing:.2px; color:#0b1220;
  background: var(--alpha-grad, linear-gradient(135deg,#F3F6FB,#E8EEF9));
  border:1px solid color-mix(in oklab, var(--alpha-color, #9fb4e0), transparent 40%);
  box-shadow:
    0 6px 16px rgba(7,16,31,.08),
    inset 0 1px 0 #fff,
    0 0 0 6px color-mix(in oklab, var(--alpha-color, #9fb4e0), transparent 82%);
}
.section-tag .count{font-weight:900; opacity:.75}
section[id^="sec-"]{ scroll-margin-top: calc(var(--appbar) + 64px) }

/* A‚ÄìZ lateral: eleva capa para evitar solapes fortuitos */
.az{ z-index:3 }
.az a{ min-height:28px }
@media (max-width:480px){ .az a{ min-height:32px } }

/* ---------- FORM / INPUTS ---------- */
.input{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#fff}
.input input{border:0;outline:0;background:transparent;font:inherit;width:100%}
.input .ico{width:18px;height:18px}

</style>
</head>
<body>
  <header class="appbar">
    <div class="container">
      <div class="brand"><span class="brand-dot"></span> Aurora UI</div>
      <h1 id="title" class="grow">Infecciosas 2.0 ¬∑ v3.3</h1>
      <div class="toolbar">
        <button class="btn" id="btn-login">Entrar</button>
        <button class="btn" id="btn-logout">Salir</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Panel Planta -->
    <section id="panel-planta" class="card" aria-label="Planta">
      <div class="card-h"><h2>Planta</h2></div>
      <div class="card-b">
        <ul id="pl-list" class="list"></ul>
      </div>
    </section>

    <!-- Panel Tareas -->
    <section id="panel-tareas" class="card" aria-label="Tareas">
      <div class="card-h"><h2>Tareas</h2></div>
      <div class="card-b">
        <ul id="t-list" class="list"></ul>
      </div>
    </section>

    <!-- Panel Directorio -->
    <section id="panel-directorio" class="card" aria-label="Directorio">
      <div class="card-h h-inter">
        <h2>Directorio telef√≥nico</h2>
        <div class="input" style="min-width:260px"><svg class="ico" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="7" stroke="#888" fill="none" stroke-width="2"/><path d="M20 20l-3.5-3.5" stroke="#888" stroke-width="2"/></svg><input id="d-q" autocomplete="off" placeholder="Buscar"/></div>
      </div>
      <div class="card-b">
        <div class="grid" style="grid-template-columns:1fr;position:relative">
          <div id="d-list-wrap"></div>
          <nav class="az" aria-label="√çndice A‚ÄìZ" id="az"></nav>
        </div>
      </div>
    </section>
  </main>

  <nav class="bottom" aria-label="Secciones">
    <div class="container">
      <div class="icons">
        <button class="btn" id="nav-planta" aria-label="Planta"><svg class="ico" width="22" height="22"><use href="#i-stetho"/></svg></button>
        <button class="btn" id="nav-tareas" aria-label="Tareas"><svg class="ico" width="22" height="22"><use href="#i-tools"/></svg></button>
        <button class="btn" id="nav-directorio" aria-label="Directorio"><svg class="ico" width="22" height="22"><use href="#i-handset"/></svg></button>
        <button class="btn" id="nav-biblioteca" aria-label="Biblioteca"><svg class="ico" width="22" height="22"><use href="#i-books"/></svg></button>
      </div>
      <div class="chip" id="chip-section" aria-live="polite">Planta</div>
    </div>
  </nav>

  <!-- Defs SVG (gradientes + s√≠mbolos) -->
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <linearGradient id="gLav" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#9cbff"/><stop offset="1" stop-color="#8B5CF6"/></linearGradient>
      <linearGradient id="gOra" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#fe9cbf"/><stop offset="1" stop-color="#FB923C"/></linearGradient>
      <linearGradient id="gInd" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#a6dbff"/><stop offset="1" stop-color="#6F7BF7"/></linearGradient>
      <linearGradient id="gGold" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#ffeaa8"/><stop offset="1" stop-color="#FACC15"/></linearGradient>

      <!-- swap -->
      <symbol id="i-swap" viewBox="0 0 24 24">
        <path fill="url(#gInd)" d="M7.1 7.5a6 6 0 0 1 10.6-2.4l1.5-1.5a1 1 0 0 1 1.4 1.4L19 6.2A6 6 0 0 1 12 12h-1v2a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1h2a4 4 0 1 0-3.1-6.3l-2 2A1 1 0 1 1 4.5 4.5l2-2A6 6 0 0 1 7.1 7.5z"/>
        <path fill="url(#gOra)" d="M16.9 16.5a6 6 0 0 1-10.6 2.4l-1.5 1.5a1 1 0 0 1-1.4-1.4L5 17.8A6 6 0 0 1 12 12h1v-2a1 1 0 1 1 2 0v3a1 1 0 0 1-1 1h-2a4 4 0 1 0 3.1 6.3l2-2a1 1 0 1 1 1.4 1.4l-2 2a6 6 0 0 1 2.4-3.2z"/>
      </symbol>

      <!-- herramientas -->
      <symbol id="i-tools" viewBox="0 0 24 24">
        <path fill="url(#gLav)" d="M4 14l6 6 2-2-6-6-2 2zm3-7a4 4 0 0 1 5.7-3.6l-2.4 2.4a2 2 0 1 0 2.8 2.8l2.4-2.4A4 4 0 0 1 17 10l-6.3 6.3A6 6 0 0 1 7 7z"/>
      </symbol>

      <!-- tel√©fono -->
      <symbol id="i-handset" viewBox="0 0 24 24">
        <path fill="url(#gInd)" d="M6.6 10.8c1.8 3 4.5 5.5 7.5 7.5.7.5 1.7.4 2.3-.2l1.5-1.5a1.8 1.8 0 0 0-.2-2.7l-2-1.2a1.8 1.8 0 0 0-1.9.1l-.9.6a12.5 12.5 0 0 1-3.9-3.9l.6-.9a1.8 1.8 0 0 0 .1-1.9l-1.2-2a1.8 1.8 0 0 0-2.7-.2L6.8 4.1c-.7.6-.8 1.6-.2 2.3z"/>
      </symbol>

      <!-- libros -->
      <symbol id="i-books" viewBox="0 0 24 24">
        <rect x="2" y="5" width="5.5" height="14" rx="1" fill="url(#gLav)"/>
        <rect x="8.5" y="5" width="5.5" height="14" rx="1" fill="url(#gOra)"/>
        <rect x="15" y="5" width="5.5" height="14" rx="1" fill="url(#gInd)"/>
      </symbol>

      <!-- fonendoscopio premium -->
      <symbol id="i-stetho" viewBox="0 0 24 24">
        <path fill="url(#gLav)" d="M6 3a1 1 0 0 1 1 1v3.2c0 2.4 1.8 4.4 4 4.6 2.2-.2 4-2.2 4-4.6V4a1 1 0 1 1 2 0v3.2c0 3.4-2.5 6.3-5.8 6.6V17a3.8 3.8 0 1 1-2 0v-3.2C7.5 13.5 5 10.6 5 7.2V4a1 1 0 0 1 1-1z"/>
        <circle cx="18" cy="16" r="3" fill="url(#gInd)"/>
        <circle cx="18" cy="16" r="1.2" fill="#fff" opacity=".9"/>
      </symbol>
    </defs>
  </svg>

  <!-- ===== FAB SOS ===== -->
  <button id="fab" class="btn primary" style="position:fixed;left:auto;right:16px;bottom:calc(var(--bottom-h) + 16px);z-index:45;gap:10px;touch-action:none" aria-haspopup="dialog" aria-controls="fabPanel" aria-expanded="false">
    SOS
  </button>
  <div id="fabPanel" class="card" role="dialog" aria-modal="false" aria-label="SOS" style="position:fixed;display:none;z-index:69; width:min(460px,96vw)">
    <div class="card-h h-inter" style="border-bottom:none"><h2>SOS</h2><button class="btn" aria-label="Configurar SOS">‚öô Configurar SOS</button></div>
    <div class="card-b">
      <div id="fabList"></div>
      <div id="fabPager" class="toolbar" style="justify-content:space-between;margin-top:12px"></div>
    </div>
  </div>

  <script>
  // ===== Helpers =====
  const $=s=>document.querySelector(s); const $$=s=>[...document.querySelectorAll(s)];
  const esc=s=>String(s??'').replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]));
  const norm=s=>String(s||'').normalize('NFD').replace(/\p{Diacritic}/gu,'').toLowerCase().trim();

  // Ajuste viewport para Android (rotaci√≥n)
  const setVH=()=>{const h=window.innerHeight; document.documentElement.style.setProperty('--vh', h+'px')};
  setVH(); addEventListener('resize', setVH); addEventListener('orientationchange', setVH);

  // ===== Datos (simulados / placeholders) =====
  let dirCache=[];

  function telHref(p){
    const digits=String(p||'').replace(/[^+\d]/g,'');
    return digits?`tel:${digits}`:'';
  }
  function telPills(raw){
    const parts=String(raw||'').split(/[,;\n]| {2,}/).map(s=>s.trim()).filter(Boolean);
    return parts.map(p=>{const href=telHref(p); return href?`<a class="pill tel" href="${href}" dir="ltr">${esc(p)}</a>`:`<span class="pill tel" dir="ltr">${esc(p)}</span>`}).join(' ');
  }

  function alphaGrad(ch){
    const palette = [
      {gx:'linear-gradient(135deg,#EAF2FF,#CFE2FF)', c:'#3B82F6'}, // A
      {gx:'linear-gradient(135deg,#FDE7FA,#F3B1EF)', c:'#DB2777'}, // B
      {gx:'linear-gradient(135deg,#E8FFFB,#B3F4E9)', c:'#06B6D4'}, // C
      {gx:'linear-gradient(135deg,#FFF3E4,#FFD0A3)', c:'#FB923C'}, // D
      {gx:'linear-gradient(135deg,#E9FFF1,#B2F5D4)', c:'#10B981'}, // E
      {gx:'linear-gradient(135deg,#EDF2FF,#C7D3FF)', c:'#6366F1'}, // F
      {gx:'linear-gradient(135deg,#FFE8EC,#FFA9B9)', c:'#F43F5E'}, // G
      {gx:'linear-gradient(135deg,#F5F0FF,#C7B8FF)', c:'#8B5CF6'}, // H
      {gx:'linear-gradient(135deg,#FFFBE5,#FFE783)', c:'#FACC15'}, // I
      {gx:'linear-gradient(135deg,#E8ECFF,#C9D0FF)', c:'#7C3AED'}, // J
      {gx:'linear-gradient(135deg,#E8FFF6,#C6F7E2)', c:'#059669'}, // K
      {gx:'linear-gradient(135deg,#FFEDEA,#FFC7BD)', c:'#EF4444'}, // L
    ];
    const idx = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ#'.indexOf(ch);
    return palette[(idx>=0?idx:0) % palette.length];
  }

  function renderDir(){
    const v=norm($('#d-q')?.value||''); const wrap=$('#d-list-wrap'); if(!wrap) return; wrap.innerHTML='';
    let arr=[...dirCache];
    arr.sort((a,b)=>(a.nombre||'').localeCompare(b.nombre||'')||(a.seccion||'').localeCompare(b.seccion||''));
    const filtered=v?arr.filter(x=>[x.seccion,x.nombre,String(x.telefono||''),x.notas].some(y=>norm(y).includes(v))):arr;
    const groups=new Map();
    for(const x of filtered){const k=/^[A-Za-z√Å√â√ç√ì√ö√ú√ë]/.test(x.nombre||'')? (x.nombre[0].toUpperCase()): '#'; if(!groups.has(k)) groups.set(k,[]); groups.get(k).push(x);}    
    const letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ#'.split(''); const az=$('#az'); if(az){ az.innerHTML = letters.map(ch=>`<a href="#sec-${'${'}ch}" aria-label="Ir a ${'${'}ch}">${'${'}ch}</a>`).join(''); }
    let total=0;
    for(const ch of letters){
      const list=groups.get(ch)||[]; if(!list.length) continue; total+=list.length;
      const sec=document.createElement('section'); sec.id=`sec-${'${'}ch}`; sec.setAttribute('aria-labelledby',`lbl-${'${'}ch}`);
      const header=document.createElement('div'); header.className='section-tag'; header.id=`lbl-${'${'}ch}`;
      const g = alphaGrad(ch);
      header.style.setProperty('--alpha-grad', g.gx);
      header.style.setProperty('--alpha-color', g.c);
      header.innerHTML = `<span class="lbl" aria-hidden="true">${'${'}ch}</span><span class="count">${'${'}list.length}</span>`;
      sec.appendChild(header);
      const ul=document.createElement('ul'); ul.className='list';
      list.forEach(x=>{
        const li=document.createElement('li'); li.className='item';
        li.innerHTML=`<div class="text"><div class="line"><strong>${'${'}esc(x.nombre||'')}</strong> ‚Äî ${'${'}esc(x.seccion||'')}</div><div class="line">${'${'}telPills(x.telefono||'')}</div>${'${'}x.notas?`<div class="muted">${'${'}esc(x.notas)}</div>`:''}</div>`;
        ul.appendChild(li);
      });
      sec.appendChild(ul);
      wrap.appendChild(sec);
    }
  }

  // ===== SOS (FAB) =====
  let emergency=[]; let page=0; const PAGE_SIZE=10;
  function renderEmergency(){
    const box=$('#fabList'); const start=page*PAGE_SIZE; const slice=emergency.slice(start,start+PAGE_SIZE);
    box.innerHTML = slice.length? slice.map((e,i)=>`<div style="display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);padding:8px 0"><div class="text"><strong>${'${'}esc(e.nombre)}</strong><div class="muted">${'${'}esc(e.telefono||'')}</div></div><button class="btn" aria-label="Llamar">üìû</button><button class="btn" aria-label="Eliminar" data-del="${'${'}start+i}">‚úñ</button></div>`).join('') : `<p class="muted">A√±ade accesos r√°pidos de SOS desde ‚öô Configurar.</p>`;
    const pager=$('#fabPager'); const pages=Math.ceil(emergency.length/PAGE_SIZE)||1; pager.innerHTML = `<div class="toolbar"><button class="btn" id="fabPrev">‚óÄ</button><span>P√°gina ${'${'}page+1}/${'${'}pages}</span><button class="btn" id="fabNext">‚ñ∂</button></div><div class="toolbar"><button class="btn" id="fabDelSel">Eliminar seleccionados</button></div>`;
    $('#fabPrev')?.addEventListener('click',()=>{if(page>0){page--;renderEmergency()}});
    $('#fabNext')?.addEventListener('click',()=>{const pages=Math.ceil(emergency.length/PAGE_SIZE)||1; if(page<pages-1){page++;renderEmergency()}});
  }

  // ===== INIT =====
  addEventListener('DOMContentLoaded',()=>{
    // Directorio demo
    dirCache=[
      {seccion:'Admisi√≥n', nombre:'Ana √Ålvarez', telefono:'+34 968 123 456', notas:'Centralita'},
      {seccion:'Admisi√≥n', nombre:'Andr√©s Buend√≠a', telefono:'+34 968 123 789; +34 600 123 456', notas:''},
      {seccion:'Farmacia', nombre:'Beatriz Cano', telefono:'+34 968 456 123', notas:'Guardia'},
      {seccion:'Planta 3', nombre:'Carlos D√≠az', telefono:'+34 968 456 789', notas:''},
    ];
    renderDir();
    renderEmergency();
  });
  </script>
</body>
</html>
